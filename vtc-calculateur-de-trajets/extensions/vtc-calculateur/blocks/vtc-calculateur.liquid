<div
    id="vtc-widget"
    class="vtc-widget"
    {% assign vtc_notify_endpoint = block.settings.notify_endpoint_url | strip %}
    {% assign vtc_slack_endpoint = block.settings.slack_endpoint_url | strip %}
    {% assign vtc_effective_endpoint = vtc_notify_endpoint %}
    {% if vtc_effective_endpoint == blank %}{% assign vtc_effective_endpoint = vtc_slack_endpoint %}{% endif %}
    data-notify-endpoint="{% if vtc_effective_endpoint != blank and vtc_effective_endpoint contains 'hooks.slack.com' %}{% elsif vtc_effective_endpoint != blank %}{{ vtc_effective_endpoint }}{% endif %}"
    data-slack-endpoint="{% if vtc_slack_endpoint != blank and vtc_slack_endpoint contains 'hooks.slack.com' %}{% elsif vtc_slack_endpoint != blank %}{{ vtc_slack_endpoint }}{% endif %}"
    data-slack-endpoint-url="{% if vtc_slack_endpoint != blank and vtc_slack_endpoint contains 'hooks.slack.com' %}{% elsif vtc_slack_endpoint != blank %}{{ vtc_slack_endpoint }}{% endif %}"
    {% assign vtc_booking_email_to = block.settings.booking_email_to | strip %}
    data-booking-email-to="{% if vtc_booking_email_to != blank %}{{ vtc_booking_email_to }}{% endif %}"
    data-base-fare-berline="{{ block.settings.base_fare_berline }}"
    data-price-per-km-berline="{{ block.settings.price_per_km_berline }}"
    data-base-fare-van="{{ block.settings.base_fare_van }}"
    data-price-per-km-van="{{ block.settings.price_per_km_van }}"
    data-stop-fee="{{ block.settings.stop_fee }}"
    data-quote-message="{{ block.settings.quote_message | escape }}"
    data-slack-enabled="{{ block.settings.slack_enabled }}"
    {% assign vtc_vehicle_image_berline = block.settings.vehicle_image_berline %}
    {% if vtc_vehicle_image_berline == blank %}{% assign vtc_vehicle_image_berline = block.settings.berline_image %}{% endif %}
    {% assign vtc_vehicle_image_van = block.settings.vehicle_image_van %}
    {% if vtc_vehicle_image_van == blank %}{% assign vtc_vehicle_image_van = block.settings.van_image %}{% endif %}
    {% assign vtc_vehicle_image_autre = block.settings.vehicle_image_autre %}
    {% if vtc_vehicle_image_autre == blank %}{% assign vtc_vehicle_image_autre = block.settings.autre_image %}{% endif %}

        {% comment %}Vehicles/options JSON config (preferred by vtc-booking.js).{% endcomment %}
        {% assign display_mode = block.settings.display_mode | strip %}
        {% if display_mode == blank %}{% assign display_mode = 'A' %}{% endif %}

        {% assign pricing_behavior = block.settings.pricing_behavior | strip %}
        {% if pricing_behavior == blank %}{% assign pricing_behavior = 'normal_prices' %}{% endif %}

        {% assign lead_time_threshold_minutes = block.settings.lead_time_threshold_minutes %}
        {% if lead_time_threshold_minutes == blank %}{% assign lead_time_threshold_minutes = 120 %}{% endif %}

        {% assign immediate_label = block.settings.immediate_label | strip %}
        {% if immediate_label == blank %}{% assign immediate_label = 'Imm√©diat' %}{% endif %}
        {% assign reservation_label = block.settings.reservation_label | strip %}
        {% if reservation_label == blank %}{% assign reservation_label = 'R√©servation' %}{% endif %}

        {% assign immediate_surcharge_enabled = block.settings.immediate_surcharge_enabled %}
        {% assign immediate_base_delta_amount = block.settings.immediate_base_delta_amount %}
        {% assign immediate_base_delta_percent = block.settings.immediate_base_delta_percent %}
        {% assign immediate_total_delta_percent = block.settings.immediate_total_delta_percent %}
        {% capture vehicles_json %}
            [
            {% assign first_vehicle = true %}
            {% for i in (1..6) %}
                {% assign enabled_id = 'vehicle_' | append: i | append: '_enabled' %}
                {% if block.settings[enabled_id] %}
                    {% assign id_id = 'vehicle_' | append: i | append: '_id' %}
                    {% assign label_id = 'vehicle_' | append: i | append: '_label' %}
                    {% assign base_fare_id = 'vehicle_' | append: i | append: '_base_fare' %}
                    {% assign price_per_km_id = 'vehicle_' | append: i | append: '_price_per_km' %}
                    {% assign quote_only_id = 'vehicle_' | append: i | append: '_quote_only' %}
                    {% assign image_id = 'vehicle_' | append: i | append: '_image' %}

                    {% assign vehicle_image = block.settings[image_id] %}
                    {% if i == 1 and vehicle_image == blank %}{% assign vehicle_image = vtc_vehicle_image_berline %}{% endif %}
                    {% if i == 2 and vehicle_image == blank %}{% assign vehicle_image = vtc_vehicle_image_van %}{% endif %}
                    {% if i == 3 and vehicle_image == blank %}{% assign vehicle_image = vtc_vehicle_image_autre %}{% endif %}

                    {% if first_vehicle %}{% assign first_vehicle = false %}{% else %},{% endif %}
                    {
                        "id": {{ block.settings[id_id] | default: '' | strip | json }},
                        "label": {{ block.settings[label_id] | default: '' | strip | json }},
                        "baseFare": {{ block.settings[base_fare_id] | default: '' | strip | json }},
                        "pricePerKm": {{ block.settings[price_per_km_id] | default: '' | strip | json }},
                        "quoteOnly": {% if block.settings[quote_only_id] %}true{% else %}false{% endif %},
                        "imageUrl": {% if vehicle_image != blank %}{{ vehicle_image | image_url | json }}{% else %}""{% endif %}
                    }
                {% endif %}
            {% endfor %}
            ]
        {% endcapture %}

        {% capture options_json %}
            [
            {% assign first_option = true %}
            {% for i in (1..6) %}
                {% assign enabled_id = 'option_' | append: i | append: '_enabled' %}
                {% if block.settings[enabled_id] %}
                    {% assign id_id = 'option_' | append: i | append: '_id' %}
                    {% assign label_id = 'option_' | append: i | append: '_label' %}
                    {% assign fee_id = 'option_' | append: i | append: '_fee' %}

                    {% if first_option %}{% assign first_option = false %}{% else %},{% endif %}
                    {
                        "id": {{ block.settings[id_id] | default: '' | strip | json }},
                        "label": {{ block.settings[label_id] | default: '' | strip | json }},
                        "fee": {{ block.settings[fee_id] | default: '' | strip | json }}
                    }
                {% endif %}
            {% endfor %}
            ]
        {% endcapture %}

        {% capture widget_config_json %}
            {
                "displayMode": {{ display_mode | json }},
                "pricingBehavior": {{ pricing_behavior | json }},
                "leadTimeThresholdMinutes": {{ lead_time_threshold_minutes | json }},
                "immediateLabel": {{ immediate_label | json }},
                "reservationLabel": {{ reservation_label | json }},
                "immediateSurchargeEnabled": {% if immediate_surcharge_enabled %}true{% else %}false{% endif %},
                "immediateBaseDeltaAmount": {{ immediate_base_delta_amount | default: 0 | json }},
                "immediateBaseDeltaPercent": {{ immediate_base_delta_percent | default: 0 | json }},
                "immediateTotalDeltaPercent": {{ immediate_total_delta_percent | default: 0 | json }},
                "stopFee": {{ block.settings.stop_fee | default: '' | strip | json }},
                "quoteMessage": {{ block.settings.quote_message | default: '' | strip | json }},
                "vehicles": {{ vehicles_json | strip_newlines }},
                "options": {{ options_json | strip_newlines }}
            }
        {% endcapture %}
        data-config='{{ widget_config_json | strip_newlines | escape }}'
    data-vehicle-image-berline="{% if vtc_vehicle_image_berline != blank %}{{ vtc_vehicle_image_berline | image_url }}{% endif %}"
    data-vehicle-image-van="{% if vtc_vehicle_image_van != blank %}{{ vtc_vehicle_image_van | image_url }}{% endif %}"
    data-vehicle-image-autre="{% if vtc_vehicle_image_autre != blank %}{{ vtc_vehicle_image_autre | image_url }}{% endif %}"
    data-berline-img="{% if vtc_vehicle_image_berline != blank %}{{ vtc_vehicle_image_berline | image_url }}{% endif %}"
    data-van-img="{% if vtc_vehicle_image_van != blank %}{{ vtc_vehicle_image_van | image_url }}{% endif %}"
    data-autre-img="{% if vtc_vehicle_image_autre != blank %}{{ vtc_vehicle_image_autre | image_url }}{% endif %}"
>

    {% assign vtc_widget_title = block.settings.widget_title | strip %}
    {% if vtc_widget_title == blank %}{% assign vtc_widget_title = 'VTC Smart Booking' %}{% endif %}

    <h2 class="vtc-title">{{ vtc_widget_title }}</h2>
    <p class="vtc-subtitle">Obtenez une estimation instantan√©e de votre trajet.</p>

    <!-- TYPE DE V√âHICULE -->
    <div class="vtc-section">
        <label class="vtc-label">Type de v√©hicule :</label>
        <div id="vtc-vehicles" class="vtc-radio-group"></div>
    </div>

    <!-- OPTIONS -->
    <div class="vtc-section">
        <label class="vtc-label">Options :</label>
        <div id="vtc-options"></div>

        <label class="vtc-label">Option personnalis√©e :</label>
        <input id="customOption" type="text" placeholder="Ex : plusieurs vans, car, demande sp√©ciale‚Ä¶" class="vtc-input">
    </div>

    <!-- ADRESSES -->
    <div class="vtc-section">
        <div style="display:flex;gap:10px;align-items:center;">
            <input id="start" class="vtc-input" placeholder="Adresse de d√©part" style="flex:1;width:auto;">
            <button type="button" id="geoStartBtn" aria-label="Utiliser ma position" style="padding:10px 12px;border:1px solid #ccc;border-radius:8px;background:#fff;cursor:pointer;">üìç</button>
        </div>
        <input id="end" class="vtc-input" placeholder="Adresse d‚Äôarriv√©e">

        <div id="stops-container"></div>

        <label class="vtc-checkbox" style="display:block;margin-top:10px;">
            <input type="checkbox" id="europeMode">
            √âtendre la recherche √† l‚ÄôEurope
        </label>

        <button type="button" class="vtc-add-stop" onclick="addStopField()">+ Ajouter un arr√™t</button>
    </div>

    <!-- DATE -->
    <div class="vtc-section">
        <label class="vtc-label">Date de prise en charge :</label>
        <input id="pickupDate" type="date" class="vtc-input">
    </div>

    <!-- HEURE -->
    <div class="vtc-section">
        <label class="vtc-label">Heure de prise en charge :</label>
        <input id="pickupTime" type="time" class="vtc-input">
    </div>

    <!-- BOUTON CALCUL -->
    <button type="button" class="vtc-btn" onclick="calculatePrice()">Calculer les tarifs</button>

    <!-- TARIFS (mode B) -->
    <div id="vtc-tariffs" class="vtc-section" style="display:none;"></div>

    <!-- MAP -->
    <div id="map"
         style="width:100%;height:260px;margin-top:20px;border-radius:12px;display:none;box-shadow:0 4px 12px rgba(0,0,0,0.15);">
    </div>

    <!-- R√âSUM√â TRAJET -->
    <div id="route-summary"
         style="display:none;margin-top:22px;background:#fafafa;padding:18px;border-radius:12px;border:1px solid #e5e5e5;font-family:'Inter',sans-serif;">
    </div>

    <!-- FORMULAIRE COORDONN√âES VISIBLES (B1) -->
    <div id="contact-wrapper" class="vtc-contact" style="display:none;margin-top:22px;">
        <h3 style="font-size:18px;margin-bottom:6px;">Vos coordonn√©es</h3>
        <p style="font-size:14px;opacity:0.8;margin-bottom:12px;">
            Uniquement n√©cessaire pour r√©server / √™tre recontact√©.
        </p>

        <input id="customerName" class="vtc-input" placeholder="Nom et pr√©nom">
        <input id="customerEmail" class="vtc-input" placeholder="Adresse e-mail">
        <input id="customerPhone" class="vtc-input" placeholder="T√©l√©phone">

        <p id="contact-error" style="color:#c00;font-size:14px;margin-top:6px;"></p>

        {% assign privacy_href = shop.policies.privacy_policy.url %}
        {% if privacy_href == blank %}{% assign privacy_href = '#' %}{% endif %}
        {% assign terms_href = shop.policies.terms_of_service.url %}
        {% if terms_href == blank %}{% assign terms_href = '#' %}{% endif %}

        <label class="vtc-checkbox" style="display:block;margin-top:12px;">
            <input type="checkbox" id="termsConsent" required>
            J‚Äôai lu et j‚Äôaccepte les <a href="{{ terms_href }}">Conditions</a> et la <a href="{{ privacy_href }}">Politique de confidentialit√©</a>.
        </label>

        <label class="vtc-checkbox" style="display:block;margin-top:10px;">
            <input type="checkbox" id="marketingConsent">
            J‚Äôaccepte de recevoir des offres/actualit√©s par e-mail/SMS. (facultatif, d√©sinscription possible)
        </label>

        <p id="consent-error" style="color:#c00;font-size:14px;margin-top:6px;"></p>
    </div>

    <!-- PRIX + BOUTON RESERVER -->
    <div id="result-wrapper" style="display:flex;justify-content:space-between;align-items:center;margin-top:22px;">
        <p id="result" class="vtc-result" style="margin:0;"></p>

        <button type="button" id="reserve-btn"
                disabled
                style="
                    padding:16px 26px;
                    background:#000;
                    color:white;
                    border:none;
                    border-radius:10px;
                    font-size:16px;
                    font-weight:600;
                    opacity:0.45;
                    cursor:not-allowed;
                    transition:0.25s ease;">
            R√©server mon trajet
        </button>
    </div>

</div>

{% schema %}
{
  "name": "VTC Smart Booking",
  "target": "section",
  "enabled_on": {
    "templates": ["index", "page", "product"]
  },
  "settings": [
    {
      "type": "text",
      "id": "google_maps_api_key",
      "label": "Google Maps API Key"
        },
                {
                        "type": "text",
                        "id": "widget_title",
                        "label": "Titre du widget",
                        "default": "VTC Smart Booking"
                },
            {
                "type": "select",
                "id": "display_mode",
                "label": "Mode d‚Äôaffichage (v√©hicules)",
                "default": "A",
                "options": [
                  { "value": "A", "label": "A ‚Äî Choisir le v√©hicule avant calcul" },
                  { "value": "B", "label": "B ‚Äî Afficher tous les tarifs apr√®s calcul" }
                ]
            },

            {
                "type": "select",
                "id": "pricing_behavior",
                "label": "Comportement pricing global",
                "default": "normal_prices",
                "options": [
                  { "value": "normal_prices", "label": "Normal ‚Äî Tarifs" },
                  { "value": "all_quote", "label": "Tout sur devis" },
                  { "value": "lead_time_pricing", "label": "Imm√©diat vs R√©servation (d√©lai)" }
                ]
            },

            {
                "type": "number",
                "id": "lead_time_threshold_minutes",
                "label": "Seuil (minutes) : bascule Imm√©diat/R√©servation",
                "default": 120,
                "min": 5,
                "max": 1440
            },
            {
                "type": "text",
                "id": "immediate_label",
                "label": "Libell√© Imm√©diat",
                "default": "Imm√©diat"
            },
            {
                "type": "text",
                "id": "reservation_label",
                "label": "Libell√© R√©servation",
                "default": "R√©servation"
            },

            {
                "type": "checkbox",
                "id": "immediate_surcharge_enabled",
                "label": "Majoration Imm√©diat activ√©e",
                "default": true
            },
            {
                "type": "number",
                "id": "immediate_base_delta_amount",
                "label": "Imm√©diat ‚Äî + montant sur la base (‚Ç¨)",
                "default": 0,
                "min": 0,
                "max": 10000
            },
            {
                "type": "number",
                "id": "immediate_base_delta_percent",
                "label": "Imm√©diat ‚Äî + % sur la base",
                "default": 0,
                "min": 0,
                "max": 1000
            },
            {
                "type": "number",
                "id": "immediate_total_delta_percent",
                "label": "Imm√©diat ‚Äî + % sur le total (optionnel)",
                "default": 0,
                "min": 0,
                "max": 1000
            },
        {
            "type": "text",
            "id": "base_fare_berline",
            "label": "Base fare (Berline)",
            "default": "29.99",
            "info": "Montant minimum (ex: 29.99). Utilisez un point pour les d√©cimales."
        },
        {
            "type": "text",
            "id": "price_per_km_berline",
            "label": "Prix par km (Berline)",
            "default": "2.4",
            "info": "Prix au km (ex: 2.4). Utilisez un point pour les d√©cimales."
        },
        {
            "type": "text",
            "id": "base_fare_van",
            "label": "Base fare (Van)",
            "default": "29.99",
            "info": "Montant minimum (ex: 29.99). Utilisez un point pour les d√©cimales."
        },
        {
            "type": "text",
            "id": "price_per_km_van",
            "label": "Prix par km (Van)",
            "default": "3.5",
            "info": "Prix au km (ex: 3.5). Utilisez un point pour les d√©cimales."
        },
        {
            "type": "text",
            "id": "stop_fee",
            "label": "Frais par arr√™t",
            "default": "0",
            "info": "Frais ajout√©s par arr√™t (ex: 5). Utilisez un point pour les d√©cimales."
        },
        {
            "type": "text",
            "id": "quote_message",
            "label": "Message (Sur devis)",
            "default": "Sur devis ‚Äî merci de nous contacter."
        },

                {
                    "type": "header",
                    "content": "V√©hicules (jusqu‚Äô√† 6)"
                },

                {
                    "type": "checkbox",
                    "id": "vehicle_1_enabled",
                    "label": "V√©hicule #1 activ√©",
                    "default": true
                },
                { "type": "text", "id": "vehicle_1_id", "label": "V√©hicule #1 ‚Äî ID", "default": "berline" },
                { "type": "text", "id": "vehicle_1_label", "label": "V√©hicule #1 ‚Äî Libell√©", "default": "Berline" },
                {
                    "type": "text",
                    "id": "vehicle_1_base_fare",
                    "label": "V√©hicule #1 ‚Äî Base fare",
                    "default": "29.99",
                    "info": "Montant minimum (ex: 29.99). Utilisez un point pour les d√©cimales."
                },
                {
                    "type": "text",
                    "id": "vehicle_1_price_per_km",
                    "label": "V√©hicule #1 ‚Äî Prix par km",
                    "default": "2.4",
                    "info": "Prix au km (ex: 2.4). Utilisez un point pour les d√©cimales."
                },
                { "type": "checkbox", "id": "vehicle_1_quote_only", "label": "V√©hicule #1 ‚Äî Sur devis", "default": false },
                { "type": "image_picker", "id": "vehicle_1_image", "label": "V√©hicule #1 ‚Äî Image" },

                {
                    "type": "checkbox",
                    "id": "vehicle_2_enabled",
                    "label": "V√©hicule #2 activ√©",
                    "default": true
                },
                { "type": "text", "id": "vehicle_2_id", "label": "V√©hicule #2 ‚Äî ID", "default": "van" },
                { "type": "text", "id": "vehicle_2_label", "label": "V√©hicule #2 ‚Äî Libell√©", "default": "Van 7 places" },
                {
                    "type": "text",
                    "id": "vehicle_2_base_fare",
                    "label": "V√©hicule #2 ‚Äî Base fare",
                    "default": "29.99",
                    "info": "Montant minimum (ex: 29.99). Utilisez un point pour les d√©cimales."
                },
                {
                    "type": "text",
                    "id": "vehicle_2_price_per_km",
                    "label": "V√©hicule #2 ‚Äî Prix par km",
                    "default": "3.5",
                    "info": "Prix au km (ex: 3.5). Utilisez un point pour les d√©cimales."
                },
                { "type": "checkbox", "id": "vehicle_2_quote_only", "label": "V√©hicule #2 ‚Äî Sur devis", "default": false },
                { "type": "image_picker", "id": "vehicle_2_image", "label": "V√©hicule #2 ‚Äî Image" },

                {
                    "type": "checkbox",
                    "id": "vehicle_3_enabled",
                    "label": "V√©hicule #3 activ√©",
                    "default": true
                },
                { "type": "text", "id": "vehicle_3_id", "label": "V√©hicule #3 ‚Äî ID", "default": "autre" },
                { "type": "text", "id": "vehicle_3_label", "label": "V√©hicule #3 ‚Äî Libell√©", "default": "Autre (sur devis)" },
                { "type": "text", "id": "vehicle_3_base_fare", "label": "V√©hicule #3 ‚Äî Base fare", "default": "0" },
                { "type": "text", "id": "vehicle_3_price_per_km", "label": "V√©hicule #3 ‚Äî Prix par km", "default": "0" },
                { "type": "checkbox", "id": "vehicle_3_quote_only", "label": "V√©hicule #3 ‚Äî Sur devis", "default": true },
                { "type": "image_picker", "id": "vehicle_3_image", "label": "V√©hicule #3 ‚Äî Image" },

                {
                    "type": "checkbox",
                    "id": "vehicle_4_enabled",
                    "label": "V√©hicule #4 activ√©",
                    "default": false
                },
                { "type": "text", "id": "vehicle_4_id", "label": "V√©hicule #4 ‚Äî ID", "default": "vehicle_4" },
                { "type": "text", "id": "vehicle_4_label", "label": "V√©hicule #4 ‚Äî Libell√©", "default": "V√©hicule 4" },
                { "type": "text", "id": "vehicle_4_base_fare", "label": "V√©hicule #4 ‚Äî Base fare", "default": "0" },
                { "type": "text", "id": "vehicle_4_price_per_km", "label": "V√©hicule #4 ‚Äî Prix par km", "default": "0" },
                { "type": "checkbox", "id": "vehicle_4_quote_only", "label": "V√©hicule #4 ‚Äî Sur devis", "default": false },
                { "type": "image_picker", "id": "vehicle_4_image", "label": "V√©hicule #4 ‚Äî Image" },

                {
                    "type": "checkbox",
                    "id": "vehicle_5_enabled",
                    "label": "V√©hicule #5 activ√©",
                    "default": false
                },
                { "type": "text", "id": "vehicle_5_id", "label": "V√©hicule #5 ‚Äî ID", "default": "vehicle_5" },
                { "type": "text", "id": "vehicle_5_label", "label": "V√©hicule #5 ‚Äî Libell√©", "default": "V√©hicule 5" },
                { "type": "text", "id": "vehicle_5_base_fare", "label": "V√©hicule #5 ‚Äî Base fare", "default": "0" },
                { "type": "text", "id": "vehicle_5_price_per_km", "label": "V√©hicule #5 ‚Äî Prix par km", "default": "0" },
                { "type": "checkbox", "id": "vehicle_5_quote_only", "label": "V√©hicule #5 ‚Äî Sur devis", "default": false },
                { "type": "image_picker", "id": "vehicle_5_image", "label": "V√©hicule #5 ‚Äî Image" },

                {
                    "type": "checkbox",
                    "id": "vehicle_6_enabled",
                    "label": "V√©hicule #6 activ√©",
                    "default": false
                },
                { "type": "text", "id": "vehicle_6_id", "label": "V√©hicule #6 ‚Äî ID", "default": "vehicle_6" },
                { "type": "text", "id": "vehicle_6_label", "label": "V√©hicule #6 ‚Äî Libell√©", "default": "V√©hicule 6" },
                { "type": "text", "id": "vehicle_6_base_fare", "label": "V√©hicule #6 ‚Äî Base fare", "default": "0" },
                { "type": "text", "id": "vehicle_6_price_per_km", "label": "V√©hicule #6 ‚Äî Prix par km", "default": "0" },
                { "type": "checkbox", "id": "vehicle_6_quote_only", "label": "V√©hicule #6 ‚Äî Sur devis", "default": false },
                { "type": "image_picker", "id": "vehicle_6_image", "label": "V√©hicule #6 ‚Äî Image" },

                {
                    "type": "header",
                    "content": "Options (jusqu‚Äô√† 6)"
                },

                { "type": "checkbox", "id": "option_1_enabled", "label": "Option #1 activ√©e", "default": true },
                { "type": "text", "id": "option_1_id", "label": "Option #1 ‚Äî ID", "default": "pet" },
                { "type": "text", "id": "option_1_label", "label": "Option #1 ‚Äî Libell√©", "default": "Animal de compagnie" },
                { "type": "text", "id": "option_1_fee", "label": "Option #1 ‚Äî Suppl√©ment (‚Ç¨)", "default": "20", "info": "Utilisez un point pour les d√©cimales." },

                { "type": "checkbox", "id": "option_2_enabled", "label": "Option #2 activ√©e", "default": true },
                { "type": "text", "id": "option_2_id", "label": "Option #2 ‚Äî ID", "default": "baby_seat" },
                { "type": "text", "id": "option_2_label", "label": "Option #2 ‚Äî Libell√©", "default": "Si√®ge b√©b√©" },
                { "type": "text", "id": "option_2_fee", "label": "Option #2 ‚Äî Suppl√©ment (‚Ç¨)", "default": "15", "info": "Utilisez un point pour les d√©cimales." },

                { "type": "checkbox", "id": "option_3_enabled", "label": "Option #3 activ√©e", "default": false },
                { "type": "text", "id": "option_3_id", "label": "Option #3 ‚Äî ID", "default": "option_3" },
                { "type": "text", "id": "option_3_label", "label": "Option #3 ‚Äî Libell√©", "default": "Option 3" },
                { "type": "text", "id": "option_3_fee", "label": "Option #3 ‚Äî Suppl√©ment (‚Ç¨)", "default": "0", "info": "Utilisez un point pour les d√©cimales." },

                { "type": "checkbox", "id": "option_4_enabled", "label": "Option #4 activ√©e", "default": false },
                { "type": "text", "id": "option_4_id", "label": "Option #4 ‚Äî ID", "default": "option_4" },
                { "type": "text", "id": "option_4_label", "label": "Option #4 ‚Äî Libell√©", "default": "Option 4" },
                { "type": "text", "id": "option_4_fee", "label": "Option #4 ‚Äî Suppl√©ment (‚Ç¨)", "default": "0", "info": "Utilisez un point pour les d√©cimales." },

                { "type": "checkbox", "id": "option_5_enabled", "label": "Option #5 activ√©e", "default": false },
                { "type": "text", "id": "option_5_id", "label": "Option #5 ‚Äî ID", "default": "option_5" },
                { "type": "text", "id": "option_5_label", "label": "Option #5 ‚Äî Libell√©", "default": "Option 5" },
                { "type": "text", "id": "option_5_fee", "label": "Option #5 ‚Äî Suppl√©ment (‚Ç¨)", "default": "0", "info": "Utilisez un point pour les d√©cimales." },

                { "type": "checkbox", "id": "option_6_enabled", "label": "Option #6 activ√©e", "default": false },
                { "type": "text", "id": "option_6_id", "label": "Option #6 ‚Äî ID", "default": "option_6" },
                { "type": "text", "id": "option_6_label", "label": "Option #6 ‚Äî Libell√©", "default": "Option 6" },
                { "type": "text", "id": "option_6_fee", "label": "Option #6 ‚Äî Suppl√©ment (‚Ç¨)", "default": "0", "info": "Utilisez un point pour les d√©cimales." },
        {
            "type": "text",
            "id": "notify_endpoint_url",
            "label": "Notify endpoint URL (optionnel)",
            "info": "Optionnel : laisser vide pour utiliser l‚ÄôApp Proxy (par d√©faut: /apps/vtc/api/booking-notify). Ne mettez jamais une URL Incoming Webhook Slack (hooks.slack.com) ici : elle serait expos√©e c√¥t√© storefront."
        },
        {
            "type": "text",
            "id": "slack_endpoint_url",
            "label": "Endpoint Slack (optionnel)",
            "info": "Optionnel : laisser vide pour utiliser l‚ÄôApp Proxy (par d√©faut: /apps/vtc/api/slack-booking). Ne mettez jamais une URL Incoming Webhook Slack (hooks.slack.com) ici : elle serait expos√©e c√¥t√© storefront."
        },
        {
            "type": "text",
            "id": "booking_email_to",
            "label": "Email destinataire (optionnel)",
            "info": "Optionnel (non secret) : destinataire de l'email de r√©servation. Si vide, l'app utilise BOOKING_EMAIL_TO (env)."
        },
        {
            "type": "checkbox",
            "id": "slack_enabled",
            "label": "Slack activ√©",
            "default": true
        },
        {
            "type": "image_picker",
            "id": "vehicle_image_berline",
            "label": "Image v√©hicule (Berline)"
        },
        {
            "type": "image_picker",
            "id": "vehicle_image_van",
            "label": "Image v√©hicule (Van)"
        },
        {
            "type": "image_picker",
            "id": "vehicle_image_autre",
            "label": "Image v√©hicule (Autre)"
        },
        {
            "type": "image_picker",
            "id": "berline_image",
            "label": "(Legacy) Image Berline"
        },
        {
            "type": "image_picker",
            "id": "van_image",
            "label": "(Legacy) Image Van"
        },
        {
            "type": "image_picker",
            "id": "autre_image",
            "label": "(Legacy) Image Autre"
    }
  ]
}
{% endschema %}

<script src="{{ 'vtc-booking.js' | asset_url }}" defer></script>

<script src="https://maps.googleapis.com/maps/api/js?key={{ block.settings.google_maps_api_key }}&libraries=places&callback=initAutocomplete" defer></script>

<style>
    .vtc-widget {
        max-width: 650px;
        background: #ffffff;
        padding: 26px;
        border-radius: 14px;
        box-shadow: 0 4px 18px rgba(0,0,0,0.12);
        margin: auto;
        font-family: 'Inter', sans-serif;
    }
    .vtc-label { font-weight:600; margin-bottom:6px; display:block; }
    .vtc-section { margin-bottom:22px; }
    .vtc-input { width:100%;padding:14px;margin:8px 0;border-radius:8px;border:1px solid #ccc;font-size:15px; }
    .vtc-btn {
        width:100%;
        padding:16px;
        font-size:18px;
        font-weight:600;
        background:black;
        color:white;
        border:none;
        border-radius:10px;
        cursor:pointer;
        transition:0.3s;
    }
    .vtc-btn:hover { background:#333; }
    .vtc-add-stop {
        margin-top:10px;
        background:transparent;
        border:none;
        color:#007bff;
        cursor:pointer;
    }
</style>
